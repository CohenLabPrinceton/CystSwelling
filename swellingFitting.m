low = [ 1
0.994565654312602
1.01178109460623
1.02175880449464
1.01272835326044
1.02666147288686
1.02108063090329
1.03977910235827
1.05080614366794
1.06605161992665
1.06377719130114
1.07096182800063
1.06924594150033
1.09403159460148
1.09220381858482
1.11518652123588
1.13931554257457
1.15933061483597
1.1779021510891
1.20806784462304
1.22983600554025
1.25372327002093
1.28332799991457
1.30433784546584
1.33483330809782
1.35989178413137
1.38197950629216
1.42370672338929
1.46549590222534
1.4817518395221
1.50527524346928
1.4921857238359
1.48013027166118
1.47403477859054
1.46810465048063
1.45223525653111
1.4359268232734
1.42943337900151
1.42674876667148
1.4248802180902
1.41802329251204
1.40752107868936
1.40320693627249
1.40027033209844
1.39559587852501
1.40460127324323
1.40157849296103
1.38295581483818
1.38886081581842
1.29016970502014]

med = [1
1.01822755876478
1.02863330429813
1.04557664145135
1.04028035925575
1.04679587924527
1.03741279015985
1.0515570659295
1.07954578199646
1.09327119835194
1.11108617305967
1.12517476828535
1.14555928196587
1.16514943987976
1.21057437488061
1.27939587759221
1.32745116302072
1.36316135909325
1.40713079537997
1.43731115033338
1.51495915551085
1.55858915189579
1.65063636485352
1.68265369456576
1.73509498500184
1.77612399208717
1.81924066104051
1.86036960712323
1.90212849497667
1.83568344237028
1.90625422037156
1.84884164396469
1.84344258071838
1.79286465914991
1.7978443672758
1.78454998965146
1.7751935426332
1.76138471402854
1.76554141253909
1.72240163088032
1.72500353168589
1.72421638880548
1.68901638591573
1.68720132744169
1.66166494463369
1.63477146933737
1.62473879356955
1.6339869614877
1.59472852804639
1.62070785441685
1.61748433100135
1.60850286584236
1.63374716621133
1.62737039171562
1.63349110772743
1.58411057031439
1.66965378867245
1.57192020355068
1.54902553997899
1.58807848814894
1.5872449652382
1.63229588253466
1.63294046471243
1.60835432067643
1.57346026622046
1.61860397162128
1.63084692078629
1.54662518298253
1.62317120207335
1.57776070576387
1.58602003441456
1.58414958077495
1.57249469055588
1.56214619401904
1.56647119615208
1.57273217817328
1.57249143440648
1.56326347117154
1.55581527615664
1.55399682653828
1.56403177156656
1.55184874165577
1.46229015211783
1.50470693421993
1.53971089502338
1.4408915274741
1.52345003937434
1.44243926887882
1.43239042937522
1.41801961383724
1.41429978127716
1.40056645433319
1.41239282994196
1.41167002933727
1.41110271092335
1.4103391162362
1.38159196012412
1.38815792786506
1.37416566598789
1.37647380106583
1.35570018741329
1.36235183723278
1.38830471998744
1.33701925452114
1.33013542429373
1.34147842668233
1.32201552673644
1.31832013765729
1.31768563834279
1.32428369736183
1.32398170579578
1.30595224356216
1.3064653639893
1.29938490637207
1.29664242212286
1.28376057742304
1.27513836314029
1.2706312709595] ;

high = [1
1.00582881963367
1.01537634959731
1.0131838586284
1.01815018645407
1.02774804600094
1.04159678811283
1.09179878078546
1.18758749838675
1.27187480308322
1.36575113358437
1.47570119606474
1.49164189066347
1.53112284680282
1.55771542258862
1.57828014404451
1.64714718203385
1.64472628787644
1.59352774564708
1.50029176682447
1.39129052736192
1.37431222771326
1.3994950421979
1.36888931450239
1.36501222725638
1.32935055303576
1.35853439652831
1.34685280774385
1.3212907464381
1.28719524583322
1.24317103350717
1.18769877723434
1.16170179283772
1.16043922129377
1.15829905335663
1.15909552974371
1.13990723358976
1.10631269467622
1.08678717159006
1.09256632498443
1.09143176690344
1.08957848625251
1.1044035165725
1.10404909106382
1.10360540407228
1.10408121824397
1.09997840151328
1.10971042105552
1.12787158992547] ; 

%%
close all % close all figures
figure('units', 'inches', 'position', [1 5 5 4]) ; hold on ; box on ; set(gcf, 'color', 'w') ; % create a figure
% title('', 'interpreter', 'latex') ; % title the plot
ylabel('$\tau$', 'interpreter', 'latex') ; % y axis label
xlabel('Current Density [mA/mm$^2$]', 'interpreter', 'latex') ; % x axis label
ylim([8 30]) ; % set y axis limits
xlim([0.5 2]) ; % set x axis limits
axis square % or axis equal % set axis proportions (depending on your data)
set(gca,'xscale','log','yscale','log'); % set axes to log or lin

thresh = 1.3 ; 

[~, idx_low] = min(abs(low(1:30)-thresh)) ;
[~, idx_med] = min(abs(med(1:30)-thresh)) ;
[~, idx_high] = min(abs(high(1:17)-thresh)) ;
xx = [0.7 1.1 1.5] ;
yy = [idx_low idx_med idx_high] ;

plot(xx, yy, '-ok', 'LineWidth', 1, 'MarkerSize', 3)

fit = polyfit(log(xx), log(yy), 1) ;
scale = fit(1) ;

plot(xx, 16*log(fit(2))*exp(fit(1).*log(xx)),'--k', 'LineWidth', 2) 

legend('Data', ['Linear Regression (\mu = ' num2str(fit(1)) ')'], 'iinterpreter', 'latex')

%%

figure; hold on;

plot((1:length(low))/(6^scale), low, '-g', 'LineWidth', 2) ; 
plot((1:length(med))/(9^scale), med, '-r', 'LineWidth', 2) ; 
plot((1:length(high))/(12^scale), high, '-b', 'LineWidth', 2) ; 

legend('Low', 'Medium', 'High') ;